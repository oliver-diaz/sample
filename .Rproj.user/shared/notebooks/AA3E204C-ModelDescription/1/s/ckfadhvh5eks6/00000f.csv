"0","econmod$disprog_[, `:=`(transition = paste0(from,'_',to), time_spent= time_stop - time_start), ]"
"0","# Some useful summary tables ----"
"0","disprog <- copy(econmod$disprog_)"
"0",""
"0","disprog <- disprog[,.( progressed = .N,"
"0","  mean_time_spent = mean(time_spent), "
"0","  median_time_spent = median(time_spent)"
"0","  ),"
"0","  by = .(sample, strategy_id, transition, from, to,final)]"
"0",""
"0","##  Time to progression summary ----"
"0","summary_dis <- disprog[,.( mean_progressed = mean(progressed),"
"0","                           mean_time_spent = mean(mean_time_spent), "
"0","                           med_time_spent = mean(median_time_spent),"
"0","                           time_spent05 = quantile(mean_time_spent,.05), "
"0","                           time_spent95 = quantile(mean_time_spent,.95)), "
"0","                       .(strategy_id, from, to, transition)"
"0","                       ][order(strategy_id, transition)]"
"0","per_line <- summary_dis[, .(mean_entry = sum(mean_progressed)), by = .(strategy_id,from)]"
"0",""
"0","summary_dis <- left_join(summary_dis,per_line,by = c(""strategy_id"",""from""))"
"0",""
"0","summary_dis <- summary_dis[,.(strategy_id, from, mean_entry, to, mean_progressed,  "
"0","                              med_time_spent, mean_time_spent, time_spent05, time_spent95)]"
"0","summary_dis[, `:=`(proportion= ifelse(mean_entry==0,""-"", round(mean_progressed/mean_entry,2)),"
"0","                   init_prop = round(mean_entry/n_patients,2))"
"0","            ]"
"0","names(summary_dis) <- c(""Strategy"", ""from"", ""Entered"","
"0","                         ""to"", ""Exited"",  ""Median"", ""Mean"","
"0","                         ""Low 5%"", ""Top 5%"", ""Proportion"", ""% of initial pop"")"
"0","summary_dis <- summary_dis[, `:=`(`From Line` = ifelse(from == 6, ""5+"", from),"
"0","                                  `To Line` = ifelse(to == 7, ""D"", ifelse(to == 6, ""5+"",to)),"
"0","                                  `Median Duration` = round(Median,2),"
"0","                                  `Mean Duration` = round(Mean,2),"
"0","                                  `95% - CI` = paste0(""("",round(`Low 5%`,2),"" ,"","
"0","                                  round(`Top 5%`,2), "")"")"
"0","                                  )]"
"0","summary_dis[, Transition := paste(`From Line`,'to', `To Line`)]"
"0","summary_dis <- summary_dis[,.(Strategy, `From Line`, `To Line`,"
"0","                              Transition, Proportion, `% of initial pop`,"
"0","                              `Median Duration`, `Mean Duration`,"
"0","                              `95% - CI`)]"
"0",""
"0","rm(disprog) # remove object not needed anymore"
