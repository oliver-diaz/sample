"0","### Time to progression at second line ----"
"0","pfsl2.data <- econmod$disprog_[from ==2,] "
"0","pfs_data <- lapply(seq(0,30, by =.5), "
"0","                    function(x){data.table(t=x,pfsl2.data[,.(prob = mean(time_spent>x)),"
"0","                                                          by =.(sample,strategy_id)])})"
"0","pfs_data <- do.call(rbind, pfs_data)"
"0","pfs_data <- pfs_data[, .(prob_mean = mean(prob),"
"0","                         ci_l = quantile(prob, .025),"
"0","                         ci_u = quantile(prob, .975)),"
"0","                     by = .(t,strategy_id)]"
"0","setorder(pfs_data, strategy_id, t)"
"0","set_labels(pfs_data, labels = labs, new_names = c(""strategy_name""))"
"0","ggplot(pfs_data, aes(x = t, y = prob_mean, col = strategy_name)) +"
"0","  geom_line() +  ylim(0,1) +"
"0","  geom_ribbon(aes(ymin = ci_l, ymax = ci_u, fill = strategy_name), alpha = .2, linetype=0) +"
"0","  xlab(""Years"") + ylab(""Probability"") +"
"0","  ggtitle(""Progression Free Survival at 2nd Line"") +"
"0","  theme(legend.position = ""bottom"","
"0","        legend.title = element_blank(),"
"0","        plot.title = element_text(hjust = 0.5))"
"0",""
